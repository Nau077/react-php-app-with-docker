{"ast":null,"code":"var _jsxFileName = \"/home/roman/web/php-docker-api/client/src/components/delivery__modules/delivery_form.js\";\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { sendFormData } from '../../actions/actions';\nimport FormSelect from './delivery_form-select';\nimport FormUpload from './delivery_form-upload';\nimport { schema, convert, schemaValidate } from '../../utils/VALIDATIONS';\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport blue from \"@material-ui/core/colors/blue\";\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Card from '@material-ui/core/Card';\nimport NumberFormat from 'react-number-format';\nimport PropTypes from 'prop-types';\nimport DateFnsUtils from '@date-io/date-fns';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\n\nfunction NumberFormatCustom(props) {\n  const {\n    inputRef,\n    onChange,\n    ...other\n  } = props;\n  return /*#__PURE__*/React.createElement(NumberFormat, Object.assign({}, other, {\n    getInputRef: inputRef,\n    onValueChange: values => {\n      onChange({\n        target: {\n          name: values.name,\n          value: values.value\n        }\n      });\n    },\n    isNumericString: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }\n  }));\n}\n\nNumberFormatCustom.propTypes = {\n  inputRef: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired\n};\nconst useStyles = makeStyles(theme => ({\n  card: {\n    minWidth: 275\n  },\n  button: {\n    color: blue[900],\n    margin: 10\n  },\n  root: {\n    '& .MuiTextField-root': {\n      margin: theme.spacing(1),\n      minWidth: 240,\n      maxWidth: 450,\n      width: '100%',\n      textField: {\n        flexBasis: 200,\n        textField: {\n          marginLeft: theme.spacing(1),\n          marginRight: theme.spacing(1)\n        }\n      }\n    }\n  }\n}));\n\nfunction DeliveryForm(props) {\n  const dispatch = useDispatch();\n  const [formState, setFormState] = useState({\n    values: {\n      rigion: '',\n      waterbase: '',\n      weight: '',\n      adress: '',\n      date: new Date(),\n      upload: ''\n    },\n    errors: {}\n  });\n  useEffect(() => {\n    setFormState(state => ({\n      values: { ...state.values,\n        rigion: props.rigionValue\n      },\n      errors: { ...state.errors\n      }\n    }));\n  }, [props]);\n\n  const handleChangeForm = async event => {\n    const {\n      target: {\n        name,\n        value\n      }\n    } = event;\n    const errors = await schemaValidate(name, value);\n    setFormState(state => ({\n      values: { ...state.values,\n        [name]: value\n      },\n      errors: { ...state.errors,\n        ...errors\n      }\n    }));\n  };\n\n  const handleWeightChange = name => event => {\n    (async function errors() {\n      const value = event.target.value;\n      const errors = await schemaValidate(name, value);\n      setFormState(state => ({\n        values: { ...state.values,\n          [name]: value\n        },\n        errors: { ...state.errors,\n          ...errors\n        }\n      }));\n    })();\n  };\n\n  const handleDateChange = name => value => {\n    (async function errors() {\n      const errors = await schemaValidate(name, value);\n      setFormState(state => ({\n        values: { ...state.values,\n          [name]: value\n        },\n        errors: { ...state.errors,\n          ...errors\n        }\n      }));\n    })();\n  };\n\n  const handleSelectError = message => {\n    setFormState({\n      values: { ...formState.values\n      },\n      errors: { ...formState.errors,\n        waterbase: message\n      }\n    });\n  };\n\n  const handleSelectChange = (message, value) => {\n    setFormState({\n      values: { ...formState.values,\n        waterbase: value\n      },\n      errors: { ...formState.errors,\n        waterbase: message\n      }\n    });\n  };\n\n  const handleUploadFile = value => {\n    setFormState({\n      values: { ...formState.values,\n        upload: value\n      },\n      errors: { ...formState.errors\n      }\n    });\n  };\n\n  const handleSubmit = callback => {\n    return async function (event) {\n      event.preventDefault();\n      let errors = await schema.validate(formState.values, {\n        abortEarly: false\n      }).then(_ => ({})) // сбрасывает объект ошибок состояния, если ошибок нет\n      .catch(convert);\n      setFormState(state => ({\n        values: { ...state.values\n        },\n        errors\n      }));\n\n      const isError = () => Object.entries(errors);\n\n      if (!isError().length) {\n        callback(formState.values);\n      }\n    };\n  };\n\n  const sendForm = form => {\n    dispatch(sendFormData(form));\n  };\n\n  const getError = (state, prop) => {\n    if (state.errors[prop]) return true;\n    return false;\n  };\n\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(Card, {\n    className: classes.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    className: classes.root,\n    autoComplete: \"off\",\n    onSubmit: handleSubmit(form => {\n      sendForm(form);\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }, props.rigionValue ? /*#__PURE__*/React.createElement(TextField, {\n    required: true,\n    id: \"standard-required1\",\n    label: \"\\u0412\\u0430\\u0448 \\u0440\\u0435\\u0433\\u0438\\u043E\\u043D\",\n    className: classes.textField,\n    value: props.rigionValue,\n    InputProps: {\n      readOnly: true\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 35\n    }\n  }) : /*#__PURE__*/React.createElement(CircularProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 16\n    }\n  }), /*#__PURE__*/React.createElement(FormSelect, {\n    handleSelectChange: handleSelectChange,\n    handleSelectError: handleSelectError,\n    name: formState.waterbase,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 13\n    }\n  }), formState.errors && formState.errors.waterbase && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"waterbase-error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 15\n    }\n  }, \"\\u041F\\u043E\\u043B\\u0435 \\u0432\\u043E\\u0434\\u043E\\u0431\\u0430\\u0437\\u044B \\u043D\\u0435\\u043E\\u0431\\u0445\\u043E\\u0434\\u0438\\u043C\\u043E \\u0432\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C\")), /*#__PURE__*/React.createElement(TextField, {\n    name: \"weight\",\n    id: \"standard-required2\",\n    label: \"\\u041D\\u0430\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u043C\\u0430\\u0441\\u0441\\u0443 \\u0432\\u043E\\u0434\\u044B \\u0432 \\u0442\\u043E\\u043D\\u043D\\u0430\\u0445\",\n    className: classes.textField,\n    value: formState.values.weight,\n    onChange: handleWeightChange('weight'),\n    helperText: formState.errors.weight ? formState.errors.weight : \"\",\n    error: getError(formState, 'weight'),\n    InputProps: {\n      inputComponent: NumberFormatCustom,\n      endAdornment: /*#__PURE__*/React.createElement(InputAdornment, {\n        position: \"end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 35\n        }\n      }, \"T\")\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    name: \"adress\",\n    label: \"\\u041D\\u0430\\u043F\\u0438\\u0448\\u0438\\u0442\\u0435 \\u0430\\u0434\\u0440\\u0435\\u0441\\u0441\",\n    value: formState.values.adress,\n    onChange: handleChangeForm,\n    fullWidth: true,\n    error: getError(formState, 'adress'),\n    helperText: formState.errors.adress ? formState.errors.adress : \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 14\n    }\n  }), /*#__PURE__*/React.createElement(MuiPickersUtilsProvider, {\n    utils: DateFnsUtils,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"MM/dd/yyyy\",\n    margin: \"normal\",\n    id: \"date-picker-inline\",\n    label: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0430\\u0442\\u0443\",\n    value: formState.values.date,\n    onChange: handleDateChange('date'),\n    helperText: formState.errors.date ? formState.errors.date : \"\",\n    error: getError(formState, 'date'),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 14\n    }\n  })), /*#__PURE__*/React.createElement(FormUpload, {\n    handleUploadFile: handleUploadFile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    className: classes.button,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 15\n    }\n  }, \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\")))));\n}\n\nexport default DeliveryForm;","map":{"version":3,"sources":["/home/roman/web/php-docker-api/client/src/components/delivery__modules/delivery_form.js"],"names":["React","useState","useEffect","useCallback","useRef","useDispatch","sendFormData","FormSelect","FormUpload","schema","convert","schemaValidate","TextField","makeStyles","InputAdornment","blue","CardContent","Button","Card","NumberFormat","PropTypes","DateFnsUtils","CircularProgress","MuiPickersUtilsProvider","KeyboardDatePicker","NumberFormatCustom","props","inputRef","onChange","other","values","target","name","value","propTypes","func","isRequired","useStyles","theme","card","minWidth","button","color","margin","root","spacing","maxWidth","width","textField","flexBasis","marginLeft","marginRight","DeliveryForm","dispatch","formState","setFormState","rigion","waterbase","weight","adress","date","Date","upload","errors","state","rigionValue","handleChangeForm","event","handleWeightChange","handleDateChange","handleSelectError","message","handleSelectChange","handleUploadFile","handleSubmit","callback","preventDefault","validate","abortEarly","then","_","catch","isError","Object","entries","length","sendForm","form","getError","prop","classes","readOnly","inputComponent","endAdornment"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { sendFormData } from '../../actions/actions';\n\nimport FormSelect from './delivery_form-select'\nimport FormUpload from './delivery_form-upload'\nimport {schema, convert, schemaValidate} from '../../utils/VALIDATIONS'\n\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport blue from \"@material-ui/core/colors/blue\";\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Card from '@material-ui/core/Card';\nimport NumberFormat from 'react-number-format';\nimport PropTypes from 'prop-types';\nimport DateFnsUtils from '@date-io/date-fns';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\n \nimport {\n    MuiPickersUtilsProvider,\n    KeyboardDatePicker,\n  } from '@material-ui/pickers';\n\nfunction NumberFormatCustom(props) {\n    const { inputRef, onChange, ...other } = props;\n    return (\n      <NumberFormat\n        {...other}\n        getInputRef={inputRef}\n        onValueChange={values => {\n          onChange({\n            target: {\n              name: values.name,\n              value: values.value,\n            },\n          });\n        }}\n        isNumericString\n      />\n    );\n  }\n  \n  NumberFormatCustom.propTypes = {\n    inputRef: PropTypes.func.isRequired,\n    onChange: PropTypes.func.isRequired,\n  };\n  \nconst useStyles = makeStyles((theme) => ({\n    card: {\n      minWidth: 275,\n    },\n    button: {\n      color: blue[900],\n      margin: 10\n    },\n    root: {\n      '& .MuiTextField-root': {\n        margin: theme.spacing(1),\n        minWidth: 240,\n        maxWidth: 450,\n        width: '100%',\n        textField: {\n            flexBasis: 200,\n            textField: {\n                marginLeft: theme.spacing(1),\n                marginRight: theme.spacing(1),\n              },\n          },\n      },\n    },\n  }));\n\nfunction DeliveryForm(props) {\n \n    const dispatch = useDispatch();\n    const [formState, setFormState] = useState({\n      values: {\n        rigion: '',\n        waterbase: '',\n        weight: '',\n        adress: '',\n        date: new Date(),\n        upload: ''\n      },\n      errors: {}\n    });\n\n      useEffect(() => {\n        setFormState(state => ({\n          values: {...state.values, rigion: props.rigionValue },\n          errors: {...state.errors }\n        }))\n      }, [props]);\n    \n      const handleChangeForm = async (event) => {\n \n        const {target : { name, value }} = event\n        const errors = await schemaValidate(name, value)\n        \n          setFormState(state => ({\n            values: {...state.values, [name]: value},\n            errors: {...state.errors, ...errors}\n          }))\n      };\n\n      const handleWeightChange = name =>  event => {\n        \n          (async function errors() {\n           const value = event.target.value\n           const errors = await schemaValidate(name, value)\n\n            setFormState( state => ({\n                        values: {...state.values, [name] : value},\n                        errors: {...state.errors, ...errors}\n                      })\n                );\n        }())\n       \n      };\n\n      const handleDateChange = name => value => {\n        \n        (async function errors() {\n          const errors = await schemaValidate(name, value)\n\n          setFormState( state => ({\n                      values: {...state.values, [name] : value},\n                      errors: {...state.errors, ...errors}\n                    })\n                  );\n      }())\n     \n    };\n      const handleSelectError = (message) => {\n        \n        setFormState({\n          values: {...formState.values},\n          errors: {...formState.errors, waterbase: message}\n         });\n\n      }\n      \n      const handleSelectChange = (message, value) => {\n        setFormState({\n             values: {...formState.values, waterbase : value },\n             errors: {...formState.errors, waterbase: message}\n            });\n      };\n\n\n    const handleUploadFile = value => {\n        setFormState({\n          values: {...formState.values, upload : value },\n          errors: {...formState.errors}\n          });\n    };\n\n    const handleSubmit = (callback) => {\n     return async function (event) {\n       event.preventDefault();\n       \n       let errors = await schema.validate(formState.values, {abortEarly : false})\n          .then(_ => ({})) // сбрасывает объект ошибок состояния, если ошибок нет\n          .catch(convert)\n\n \n        setFormState(state => ({\n          values: {...state.values },\n          errors\n      }))\n      \n      const isError = () => Object.entries(errors)\n\n      if (!isError().length) {\n          callback(formState.values)\n      }\n    }\n  }\n\n  const sendForm = (form ) => {\n    dispatch(sendFormData(form))\n  }\n    const getError = (state, prop) => {\n      if (state.errors[prop]) return true\n      return false\n    }\n\n    const classes = useStyles();\n\n    return (\n      <Card className={classes.card}>\n        <CardContent>\n        <div className=\"form-wrapper\">\n        <form className={classes.root} autoComplete=\"off\" onSubmit={handleSubmit(form => {\n          sendForm(form)\n        })}>\n             {props.rigionValue ? <TextField \n                required \n                id=\"standard-required1\" \n                label=\"Ваш регион\"\n                className={classes.textField}\n                value={props.rigionValue}\n                InputProps={{\n                    readOnly: true,\n                }}\n             />\n             : <CircularProgress />\n            }\n            <FormSelect handleSelectChange={handleSelectChange} handleSelectError={handleSelectError} name={formState.waterbase}/>\n            {formState.errors && formState.errors.waterbase &&\n            <div>\n              <p className=\"waterbase-error\">Поле водобазы необходимо выбрать</p>\n            </div>\n            }\n            <TextField \n                name=\"weight\"\n                id=\"standard-required2\"\n                label=\"Напишите массу воды в тоннах\"\n                className={classes.textField}\n                value={formState.values.weight}\n                onChange={handleWeightChange('weight')}\n                helperText={formState.errors.weight ? formState.errors.weight : \"\"}\n                error={ getError(formState, 'weight')}\n                InputProps={{\n                    inputComponent: NumberFormatCustom,\n                    endAdornment: <InputAdornment position=\"end\">T</InputAdornment>,\n                  }}\n             />\n             <TextField\n                name=\"adress\"\n                label=\"Напишите адресс\"\n                value={formState.values.adress}\n                onChange={handleChangeForm}\n                fullWidth\n                error={ getError(formState, 'adress')}\n                helperText={formState.errors.adress ? formState.errors.adress : \"\"}\n             />\n             <MuiPickersUtilsProvider utils={DateFnsUtils}>\n             <KeyboardDatePicker\n                disableToolbar\n                variant=\"inline\"\n                format=\"MM/dd/yyyy\"\n                margin=\"normal\"\n                id=\"date-picker-inline\"\n                label=\"Выберите дату\"\n                value={formState.values.date}\n                onChange={handleDateChange('date')}\n                helperText={formState.errors.date ? formState.errors.date : \"\"} \n                error={ getError(formState, 'date')}\n                KeyboardButtonProps={{\n                    'aria-label': 'change date',\n                }}\n            />\n            </MuiPickersUtilsProvider>\n            <FormUpload handleUploadFile={handleUploadFile}/>\n              <Button variant=\"outlined\" className={classes.button} type=\"submit\">\n                Отправить\n              </Button>\n         </form>\n         </div>\n         </CardContent>\n         </Card>\n    );\n}\n\nexport default DeliveryForm;"]},"metadata":{},"sourceType":"module"}